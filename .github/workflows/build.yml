name: Build Android APK

on:
  push:
      branches: [ main ]
        workflow_dispatch:

        jobs:
          build:
              runs-on: ubuntu-latest

                  steps:
                      - uses: actions/checkout@v3

                              - name: Set up JDK 17
                                    uses: actions/setup-java@v3
                                          with:
                                                  java-version: '17'
                                                          distribution: 'temurin'
                                                                  cache: gradle

                                                                          - name: Grant execute permission for gradlew
                                                                                run: chmod +x ./gradlew

                                                                                        - name: Build Release APK with Gradle
                                                                                              run: ./gradlew assembleRelease

                                                                                                      - name: Upload APK to Artifacts
                                                                                                            uses: actions/upload-artifact@v3
                                                                                                                  with:
                                                                                                                          name: app-release
                                                                                                                                  path: app/build/outputs/apk/release/
                                                                                                                                          
                                                                                                                                              - name: Create Release
                                                                                                                                                    uses: actions/create-release@v1
                                                                                                                                                          env:
                                                                                                                                                                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                                                                                                                                                                        with:
                                                                                                                                                                                tag_name: v${{ github.run_number }}
                                                                                                                                                                                        release_name: Release v${{ github.run_number }}
                                                                                                                                                                                                body: 'APK build from commit ${{ github.sha }}'
                                                                                                                                                                                                        draft: false
                                                                                                                                                                                                                prerelease: false
