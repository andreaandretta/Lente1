app/src/main/java/com/lente/app/CallReceiver.kt
package com.lente.app

import android.content.BroadcastReceiver
import android.content.Context
import android.content.Intent
import android.telephony.TelephonyManager
import android.util.Log
import androidx.work.OneTimeWorkRequestBuilder
import androidx.work.WorkManager
import androidx.work.workDataOf

class CallReceiver : BroadcastReceiver() {
    companion object {
            private const val TAG = "CallReceiver"
                    private var lastState = TelephonyManager.CALL_STATE_IDLE
                            private var lastNumber: String? = null
                                }
                                
                                    override fun onReceive(context: Context, intent: Intent) {
                                            if (intent.action != TelephonyManager.ACTION_PHONE_STATE_CHANGED) return
                                                    
                                                            val state = intent.getStringExtra(TelephonyManager.EXTRA_STATE)
                                                                    val number = intent.getStringExtra(TelephonyManager.EXTRA_INCOMING_NUMBER)
                                                                            
                                                                                    Log.d(TAG, "State: $state, Number: $number")
                                                                                            
                                                                                                    when (state) {
                                                                                                                TelephonyManager.EXTRA_STATE_RINGING -> {
                                                                                                                                lastNumber = number
                                                                                                                                                lastState = TelephonyManager.CALL_STATE_RINGING
                                                                                                                                                            }
                                                                                                                                                                        TelephonyManager.EXTRA_STATE_IDLE -> {
                                                                                                                                                                                        if (lastState == TelephonyManager.CALL_STATE_RINGING && !lastNumber.isNullOrBlank()) {
                                                                                                                                                                                                            Log.d(TAG, "Missed call from: $lastNumber")
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                            lastState = TelephonyManager.CALL_STATE_IDLE
                                                                                                                                                                                                                                                            lastNumber = null
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                    TelephonyManager.EXTRA_STATE_OFFHOOK -> {
                                                                                                                                                                                                                                                                                                    lastState = TelephonyManager.CALL_STATE_OFFHOOK
                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                            }{
  "name": "lente-android-project-dashboard",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^19.2.3",
    "react-dom": "^19.2.3",
    "@google/genai": "^1.34.0"
  },
  "devDependencies": {
    "@types/node": "^22.14.0",
    "@vitejs/plugin-react": "^5.0.0",
    "typescript": "~5.8.2",
    "vite": "^6.2.0"
  }
}
